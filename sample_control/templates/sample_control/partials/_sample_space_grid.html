{% comment %}
Renders a visual grid for the Sample Control explorer.

This partial displays the grid of spaces for a given location, with specific
styles and links tailored for sample management. It visually distinguishes
between cells occupied by samples (which are interactive), cells occupied by
other items (which are disabled), and available cells (which link to the
sample creation form).

Context Variables:
  - grid: A 2D list representing the grid of spaces, generated by the
          `generate_space_grid` utility function.
  - parent_location: The Location object instance that owns the spaces.
{% endcomment %}
{% load grid_helpers %}

<div class="space-grid" data-cols="{{ parent_location.source_location_type.space_cols }}">
    {% for row in grid %}
        {% for cell in row %}
            {% if cell.occupant_type == 'sample' %}
                {# A cell occupied by a sample. Links to the sample's detail page. #}
                <a
                    href="{% url 'sample_control:sample_detail' sample_pk=cell.occupant_id %}"
                    class="space-cell space-interactable"
                    data-sample-pk="{{ cell.occupant_id }}"
                    data-coord="{{ cell.row }},{{ cell.col }}"
                >
                    <span class="space-coords">{{ cell.row|to_row_letter }}{{ cell.col }}</span>
                    <span class="occupant-name">{{ cell.occupant_name }}</span>
                </a>

            {% elif cell.occupant_type %}
                {# A cell occupied by a non-sample item (e.g., another location). Rendered as a disabled div. #}
                <div class="space-cell space-occupied" title="Occupied by a non-sample item: {{ cell.occupant_name }}">
                    <span class="space-coords">{{ cell.row|to_row_letter }}{{ cell.col }}</span>
                    <span class="occupant-name">{{ cell.occupant_name }}</span>
                </div>

            {% else %}
                {# An available cell. Links to the 'add sample to space' view. #}
                <a
                    href="{% url 'sample_control:sample_add_to_space' location_pk=parent_location.pk space_row=cell.row space_col=cell.col %}"
                    class="space-cell space-available"
                    data-coord="{{ cell.row }},{{ cell.col }}"
                >
                    <span class="space-coords">{{ cell.row|to_row_letter }}{{ cell.col }}</span>
                    <span>Available</span>
                </a>
            {% endif %}
        {% endfor %}
    {% endfor %}
</div>